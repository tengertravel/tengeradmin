{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\admin\\\\Desktop\\\\tengeradmin\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"C:\\\\Users\\\\admin\\\\Desktop\\\\tengeradmin\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\admin\\\\Desktop\\\\tengeradmin\\\\src\\\\context\\\\UserContext.js\";\n\nimport React, { useState } from 'react';\nimport axios from '../components/Axios';\nvar UserContext = React.createContext();\nvar initialState = {\n  loading: false,\n  userId: null,\n  token: null,\n  role: null,\n  firstName: null,\n  profileImg: null,\n  errorCode: null,\n  error: null\n};\nexport var UserStore = function UserStore(props) {\n  var _useState = useState(initialState),\n      _useState2 = _slicedToArray(_useState, 2),\n      userState = _useState2[0],\n      setUserState = _useState2[1];\n\n  var loginUser = function loginUser(email, password) {\n    setUserState(_objectSpread({}, userState, {\n      loading: true\n    })); //const data = {email,password,returnToken:true};\n\n    axios.post('users/login', {\n      email: email,\n      password: password\n    }).then(function (result) {\n      var resultData = result.data.data;\n\n      if (resultData.role === 'admin' || resultData.role === 'manager' || resultData.role === 'consultant') {\n        setUserState(_objectSpread({}, userState, {\n          loading: false,\n          token: result.data.token,\n          userId: resultData._id,\n          role: resultData.role,\n          firstName: resultData.firstName,\n          error: null\n        }));\n        localStorage.setItem(\"token\", result.data.token);\n        localStorage.setItem(\"userId\", resultData._id);\n        localStorage.setItem(\"role\", resultData.role);\n        localStorage.setItem(\"firstName\", resultData.firstName);\n      } else {\n        setUserState(_objectSpread({}, userState, {\n          loading: false,\n          token: null,\n          userId: null,\n          error: \"и-мэйл болон нууц үг буруу байна.\"\n        }));\n      }\n    }).catch(function (err) {\n      var errMessage = \"Алдаа.\";\n\n      if (err.response.data.error) {\n        errMessage = err.response.data.error.message;\n      }\n\n      setUserState(_objectSpread({}, userState, {\n        loading: false,\n        token: null,\n        userId: null,\n        error: errMessage\n      }));\n    });\n  };\n\n  var loginErrorClear = function loginErrorClear() {\n    setUserState(initialState);\n  };\n\n  var logout = function logout() {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"userId\");\n    localStorage.removeItem(\"role\");\n    localStorage.removeItem(\"firstName\");\n    setUserState(initialState);\n  };\n\n  var loginSucess = function loginSucess(uToken, uId, uRole, uFName) {\n    setUserState(_objectSpread({}, userState, {\n      loading: false,\n      token: uToken,\n      userId: uId,\n      role: uRole,\n      firstName: uFName,\n      error: null\n    }));\n    return true;\n  };\n\n  return /*#__PURE__*/React.createElement(UserContext.Provider, {\n    value: {\n      userState: userState,\n      loginUser: loginUser,\n      loginErrorClear: loginErrorClear,\n      logout: logout,\n      loginSucess: loginSucess\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }\n  }, props.children);\n};\nexport default UserContext;","map":{"version":3,"names":["React","useState","axios","UserContext","createContext","initialState","loading","userId","token","role","firstName","profileImg","errorCode","error","UserStore","props","userState","setUserState","loginUser","email","password","post","then","result","resultData","data","_id","localStorage","setItem","catch","err","errMessage","response","message","loginErrorClear","logout","removeItem","loginSucess","uToken","uId","uRole","uFName","children"],"sources":["C:/Users/admin/Desktop/tengeradmin/src/context/UserContext.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport axios from '../components/Axios';\r\n\r\nconst UserContext = React.createContext();\r\nconst initialState = {\r\n    loading: false,\r\n    userId: null,\r\n    token: null,\r\n    role:null,\r\n    firstName:null,\r\n    profileImg:null,\r\n    errorCode:null,\r\n    error: null,\r\n}\r\n\r\nexport const UserStore = (props) =>{\r\n    const [userState, setUserState] = useState(initialState);\r\n    const loginUser = (email, password) =>{\r\n        setUserState({...userState, loading:true });\r\n        //const data = {email,password,returnToken:true};\r\n        axios.post('users/login',{\r\n        email: email,\r\n        password: password\r\n        }).then((result) => {\r\n            const resultData = result.data.data;\r\n            if(resultData.role === 'admin' || resultData.role === 'manager' || resultData.role === 'consultant'){\r\n                setUserState({...userState, \r\n                    loading:false,token:result.data.token,userId:resultData._id,\r\n                    role:resultData.role,firstName:resultData.firstName,\r\n                    error:null\r\n                });\r\n                localStorage.setItem(\"token\",result.data.token);\r\n                localStorage.setItem(\"userId\",resultData._id);\r\n                localStorage.setItem(\"role\",resultData.role);\r\n                localStorage.setItem(\"firstName\",resultData.firstName);\r\n            }else{\r\n                setUserState({...userState, loading:false,token:null,userId:null, error:\"и-мэйл болон нууц үг буруу байна.\"});\r\n            }\r\n        }).catch((err) => {\r\n            let errMessage=\"Алдаа.\";\r\n            if(err.response.data.error){errMessage = err.response.data.error.message;}\r\n            setUserState({...userState, loading:false,token:null,userId:null, error:errMessage});\r\n        });\r\n    }\r\n    const loginErrorClear = () =>{\r\n        setUserState(initialState);\r\n    }\r\n    const logout = () =>{\r\n        localStorage.removeItem(\"token\");\r\n        localStorage.removeItem(\"userId\");\r\n        localStorage.removeItem(\"role\");\r\n        localStorage.removeItem(\"firstName\");\r\n        setUserState(initialState);\r\n    }\r\n    const loginSucess = (uToken,uId,uRole,uFName)=>{\r\n        setUserState({...userState, \r\n            loading:false,token:uToken,userId:uId,\r\n            role:uRole,firstName:uFName,\r\n            error:null\r\n        });\r\n        return true;\r\n    }\r\n\r\n    return(\r\n        <UserContext.Provider value={{ userState, loginUser, loginErrorClear, logout, loginSucess }}>\r\n            {props.children}\r\n        </UserContext.Provider>\r\n    );\r\n}\r\n\r\nexport default UserContext;"],"mappings":"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"},"metadata":{},"sourceType":"module"}